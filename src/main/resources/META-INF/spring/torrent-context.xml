<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd 
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd">

	<bean id="httpScrapeRequestHandlerId" class="io.delimeat.core.torrent.HttpScrapeRequestHandler_Impl">
    	<property name="urlHandler" ref="urlHandlerId"/>
    </bean>
    
    <bean id="udpScrapeBindAddressId" class="java.net.InetAddress" factory-method="getByName">
    	<constructor-arg value="${io.delimeat.core.torrent.udp.address}"/>
    </bean>
    <bean id="udpScrapeRequestHandlerId" class="io.delimeat.core.torrent.UDPScrapeRequestHandler_Impl">
    	<property name="socket">
    		<bean class="java.net.DatagramSocket">
    			<constructor-arg type="int" value="${io.delimeat.core.torrent.udp.port}"/>
    			<constructor-arg type="java.net.InetAddress" ref="udpScrapeBindAddressId"/>
    		</bean>
    	</property>
    </bean>
    
    <bean id="torrentDaoId" class="io.delimeat.core.torrent.TorrentDao_Impl">
    	<property name="urlHandler" ref="urlHandlerId"/>
    	<property name="scrapeRequestHandlers">
    		<map> 
    			<entry key="HTTP" value-ref="httpScrapeRequestHandlerId"/>
    			<entry key="UDP" value-ref="udpScrapeRequestHandlerId"/>
    		</map>
    	</property>
    </bean>
    
</beans>